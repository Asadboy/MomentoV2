# Momento V1 Design

**Date:** 2026-02-03
**Status:** Approved

## Philosophy

V1 is the beta, stripped back and monetized. The core loop (create, capture, reveal) is proven. V1 simplifies the host experience, adds a real payment layer, and introduces constraints that make premium worth buying. Ship fast, validate whether people pay.

---

## Scope

### What ships
- Fixed event timing (host picks start, rest is automatic)
- RevenueCat payment integration (£7.99 one-time per event)
- Premium prompted after reveal, never at creation
- Watermark on free downloads
- Share button in reveal feed with deep link branding
- Free events auto-delete 7 days post-reveal
- Premium events persist + web album link + clean downloads
- Database migration to simplified 5-table schema

### What gets cut from current app
- Custom time pickers for end/reveal (auto-calculated)
- Premium toggle at event creation
- Keepsakes/badges system (deferred)
- Host curation (deferred)

### What stays as-is
- Photo capture + offline sync + BethanReynolds filter
- Reveal feed experience (swipe, flip animation, likes)
- Liked gallery + full gallery
- Google Sign-In + Apple Sign-In
- Invite system (QR + join code)
- PostHog analytics (to be revisited separately)

---

## Event Flow

### Creation
1. Host enters event name
2. Host picks a start time (date + time picker)
3. App shows computed times (informational, not editable):
   - "Capture ends [start + 12hrs]"
   - "Photos reveal [start + 24hrs]"
4. Host shares invite (QR code, join code, invite card)

### Lifecycle
```
Upcoming → Live (12hrs) → Processing (12hrs) → Revealed
```
- **Upcoming:** countdown to start time
- **Live:** camera active, photos uploading in background
- **Processing:** "developing your photos" with countdown to reveal
- **Revealed:** feed swipe, likes, downloads, sharing

### Timing Rules (non-negotiable in v1)
- Capture window: 12 hours from start
- Reveal: 12 hours after capture ends (24hrs from start)
- No extended capture, no custom reveal, no multi-day events
- `ends_at` stored in database for future premium flexibility

---

## Reveal Experience

### During reveal (per photo card)
- Tap to flip/reveal (existing)
- Like button (existing)
- **Share button (new)** - native iOS share sheet
  - Instagram Stories, iMessage, WhatsApp, etc.
  - Shared image includes subtle Momento branding in corner + deep link
  - Share text: "Check out this moment from [event name] - yourmomento.app"
- Photographer name + timestamp (existing)
- Progress indicator (existing)

### End of reveal
- Stats summary (photos liked, total photos)
- Premium prompt: "Turn this moment into a keepsake"
- Skip option clearly available

### Post-reveal (gallery)
- Liked gallery with download + share
- Full event gallery browsable
- Premium prompt accessible again from event screen if skipped

---

## Watermarks

Two distinct watermark types:

1. **Free download watermark** - more visible, applied to photos saved to camera roll on free events. Removed when premium is purchased.
2. **Share branding** - subtle corner badge on any photo shared from within the app (free and premium). Marketing, not a paywall. Always present.

Both to be evaluated visually during implementation and adjusted as needed.

---

## Premium (£7.99 per event)

### What it unlocks
- Photos persist forever (no 7-day auto-delete)
- Watermark removed from downloads
- Web album link generated and shareable (existing web album infrastructure)
- `is_premium` set to `true` on the event

### When it's offered
- **Primary:** post-reveal prompt after user engages (likes or downloads photos)
- **Secondary:** accessible from event screen anytime after reveal
- **Never:** during event creation or capture

### Payment flow
1. User taps "Turn this into a keepsake"
2. RevenueCat paywall presented
3. Apple payment processed
4. On success: event marked `is_premium = true` in Supabase
5. Watermarks removed, web album link becomes available
6. Analytics event fired to PostHog

### Purchase verification
- RevenueCat webhook hits Supabase Edge Function to verify server-side
- Client does not self-report premium status

---

## Free Tier

- Unlimited photos during capture
- Full reveal experience (no gating)
- Download photos (with watermark)
- Share photos (with branding)
- Event auto-deletes 7 days after reveal
- Countdown shown on event: "This momento expires in X days"

---

## Database Schema

### Architecture
- Client-direct to Supabase (no API layer)
- Supabase Edge Functions for server-side logic (reveal scheduling, cleanup, RevenueCat webhooks)
- 5 tables: profiles, events, event_members, photos, photo_likes

### Events table (updated from backend stack doc)
```sql
CREATE TABLE public.events (
  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),
  name text NOT NULL,
  join_code text NOT NULL UNIQUE,
  creator_id uuid NOT NULL REFERENCES auth.users(id),
  starts_at timestamptz NOT NULL,
  ends_at timestamptz NOT NULL,
  release_at timestamptz NOT NULL,
  is_premium boolean DEFAULT false,
  is_deleted boolean DEFAULT false,
  created_at timestamptz DEFAULT now()
);
```

`ends_at` is auto-calculated at creation (starts_at + 12hrs) but stored explicitly for future premium flexibility.

All other tables remain as defined in `Docs/Momento-Backend-Stack.md`.

---

## Implementation Order

1. Database migration (schema changes on Supabase, migrate existing beta data)
2. Update Swift models to match new schema
3. Update SupabaseManager queries
4. Simplify event creation UI (auto-calculate ends_at + release_at)
5. Add share button to reveal feed with deep link branding
6. Build watermark system (free download watermark + share branding)
7. Integrate RevenueCat
8. Build post-reveal premium prompt
9. Wire up web album link for premium events
10. Build 7-day auto-delete Edge Function
11. Build expiry countdown UI on free events

---

## What comes after v1

- Host curation (hide photos from web album)
- Premium timing controls (custom capture/reveal windows)
- Push notifications (reveal ready, someone joined)
- Keepsakes/badges system
- PostHog dashboard buildout (separate discussion)
